<section class="extended-reading">
  <h2>Extended Reading</h2>

  {% if reading_intro %}
  <p class="reading-intro">{{ reading_intro }}</p>
  {% endif %}

  {% for tagId in reading_tags %}
    {% set tag = reading_tag_groups | getReadingTagById(tagId) %}
    {% if tag %}
    <div class="reading-group">
      <h3>{{ tag.title }}</h3>
      {% if tag.description %}
      <p class="group-description">{{ tag.description }}</p>
      {% endif %}
      <ul class="source-list">
        {% for source in sources | getSourcesByTag(tagId) %}
        {% set tagDescription = source.reading_descriptions and source.reading_descriptions[tagId] %}
        <li class="source-item">
          {% if source %}
          <strong>
            {% if source.author %}{{ source.author }} — {% endif %}
            {% if source.publisher and not source.author %}{{ source.publisher }} — {% endif %}
            {% if source.url %}
              <a href="{{ source.url }}">{{ source.title }}</a>
            {% else %}
              {{ source.title }}
            {% endif %}
          </strong>
          {% else %}
          <strong>{{ source.id }}</strong>
          {% endif %}
          {% if tagDescription %}
          <p>{{ tagDescription }}</p>
          {% endif %}
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  {% endfor %}
</section>
