---
layout: layouts/base.njk
pagination:
  data: people
  size: 1
  alias: person
permalink: "/people/{{ person | getPersonSlug }}/"
eleventyComputed:
  title: "{{ person.name }}"
---

{% set profileImage = person | resolveProfileImage %}
{% set profileSummary = person.profile_summary or person.summary %}
{% set featuredWorks = person.featured_works or person.links %}

<header class="person-header person-profile__header{% if not profileImage %} person-header--no-photo{% endif %}">
  {% if profileImage %}
  <img
    class="person-profile__photo"
    src="{{ profileImage | url }}"
    alt="{{ person.profile_image_alt or (person.name ~ ' profile photo') }}"
    loading="lazy"
  >
  {% endif %}
  <div class="person-header__content">
    <h1>{{ person.name }}</h1>
    {% if person.primary_domain or (person.secondary_domains and person.secondary_domains.length) %}
    {% set primary_domain = person.primary_domain %}
    {% set secondary_domains = person.secondary_domains %}
    {% include "components/domain-badges.njk" %}
    {% endif %}
    {% if profileSummary %}
    <p class="person-profile__summary">{{ profileSummary }}</p>
    {% endif %}
  </div>
</header>

{% if person.social_links %}
  <section>
    <h2>Connect</h2>
    <ul class="meta-list">
      {%- for link in person.social_links %}
        <li><a href="{{ link.url }}">{{ link.label }}</a></li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

{% if featuredWorks %}
  <section>
    <h2>Featured works</h2>
    <ul class="article-list">
      {%- for work in featuredWorks %}
        <li>
          {% if work.url %}
            <a href="{{ work.url }}">{{ work.title or work.label }}</a>
          {% else %}
            {{ work.title or work.label }}
          {% endif %}
          {% if work.year %}
            <span class="meta-muted">({{ work.year }})</span>
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

{% set personSources = sources | getSourcesByPersonId(person.id) %}

{% if person.recent_items and person.recent_items.length %}
  <section>
    <h2>Recent publications</h2>
    <ul class="article-list">
      {%- for item in person.recent_items %}
        <li>
          {% if item.url %}
            <a href="{{ item.url }}">{{ item.title }}</a>
          {% else %}
            {{ item.title }}
          {% endif %}
          {% if item.published_date %}
            <span class="meta-muted">({{ item.published_date }})</span>
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  </section>
{% elseif personSources.length %}
  <section>
    <h2>Recent publications</h2>
    <ul class="article-list">
      {%- for source in personSources %}
        {% set summary = source_summaries | getSourceSummaryById(source.id) %}
        <li>
          {% if summary %}
            <a href="{{ ('/summaries/' ~ source.id ~ '/') | url }}">{{ source.title }}</a>
          {% else %}
            {{ source.title }}
          {% endif %}
          {% if source.url %}
            <div class="summary-links">
              <a href="{{ source.url }}">Original source</a>
            </div>
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

{% set relatedArticles = [] %}
{%- for article in collections.articles %}
  {% set articleSourceIds = article.data.blocks | collectBlockSourceIds(collections.argumentBlocks, citations) %}
  {% set matches = false %}
  {%- for source in personSources %}
    {%- if source.id in articleSourceIds %}
      {% set matches = true %}
    {%- endif %}
  {%- endfor %}
  {% if matches %}
    {% set relatedArticles = relatedArticles.concat([article]) %}
  {% endif %}
{%- endfor %}

{% if relatedArticles.length %}
  <section>
    <h2>Related Draft artifacts</h2>
    <ul class="article-list">
      {%- for article in relatedArticles %}
        <li>
          <a href="{{ article.url | url }}">{{ article.data.title }}</a>
          {% if article.data.summary %}
            <p class="article-summary">{{ article.data.summary }}</p>
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

<p><a class="back-link" href="{{ '/people/' | url }}">‚Üê Back to people</a></p>
