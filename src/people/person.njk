---
layout: layouts/base.njk
pagination:
  data: people
  size: 1
  alias: person
permalink: "/people/{{ person.id }}/"
eleventyComputed:
  title: "{{ person.name }}"
---

<h1>{{ person.name }}</h1>

{% set profileImage = person | resolveProfileImage %}

{% if profileImage or person.title or person.summary %}
  <section class="person-profile">
    <div class="person-profile__header">
      {% if profileImage %}
        <img
          class="person-profile__photo"
          src="{{ profileImage | url }}"
          alt="{{ person.name }} profile photo"
          loading="lazy"
        >
      {% endif %}
      <div>
        {% if person.title %}
          <p class="person-profile__title">{{ person.title }}</p>
        {% endif %}
        {% if person.summary %}
          <p class="person-profile__summary">{{ person.summary }}</p>
        {% endif %}
      </div>
    </div>
  </section>
{% endif %}

{% if person.social_links %}
  <section>
    <h2>Connect</h2>
    <ul class="meta-list">
      {%- for link in person.social_links %}
        <li><a href="{{ link.url }}">{{ link.label }}</a></li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

{% if person.links %}
  <section>
    <h2>Links</h2>
    <ul>
      {%- for link in person.links %}
        <li><a href="{{ link.url }}">{{ link.label }}</a></li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

{% set personSources = sources | getSourcesByPersonId(person.id) %}

{% if personSources.length %}
  <section>
    <h2>Sources</h2>
    <ul class="article-list">
      {%- for source in personSources %}
        {% set summary = source_summaries | getSourceSummaryById(source.id) %}
        <li>
          {% if summary %}
            <a href="{{ ('/summaries/' ~ source.id ~ '/') | url }}">{{ source.title }}</a>
          {% else %}
            {{ source.title }}
          {% endif %}
          {% if source.url %}
            <div class="summary-links">
              <a href="{{ source.url }}">Original source</a>
            </div>
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

{% set relatedArticles = [] %}
{%- for article in collections.articles %}
  {% set articleSourceIds = article.data.blocks | collectBlockSourceIds(collections.argumentBlocks, citations) %}
  {% set matches = false %}
  {%- for source in personSources %}
    {%- if source.id in articleSourceIds %}
      {% set matches = true %}
    {%- endif %}
  {%- endfor %}
  {% if matches %}
    {% set relatedArticles = relatedArticles.concat([article]) %}
  {% endif %}
{%- endfor %}

{% if relatedArticles.length %}
  <section>
    <h2>Related articles</h2>
    <ul class="article-list">
      {%- for article in relatedArticles %}
        <li>
          <a href="{{ article.url | url }}">{{ article.data.title }}</a>
          {% if article.data.summary %}
            <p class="article-summary">{{ article.data.summary }}</p>
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  </section>
{% endif %}

<p><a href="{{ '/people/' | url }}">Back to people</a></p>
