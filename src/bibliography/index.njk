---
layout: layouts/base.njk
title: Bibliography
---

<h1>Bibliography</h1>
<p class="summary-intro">A complete, searchable index of every source powering The Draft. Open a summary or jump straight to the original citation.</p>

<div class="search-field">
  <label for="bibliography-search">Search sources or summaries</label>
  <input id="bibliography-search" type="search" placeholder="Search by title, author, or tag" data-bibliography-search>
</div>

<div class="summary-grid" data-bibliography-grid>
  {%- for source in sources %}
    {%- set summary = source_summaries | getSourceSummaryById(source.id) %}
    <article class="summary-card" data-bibliography-card data-search="{{ [source.title, source.author, source.publisher, source.repository, summary.summary, summary.long_summary, summary.tags | join(' '), summary.topics | join(' '), summary.categories | join(' ')] | join(' ') | lower }}">
      <h3>{{ source.title }}</h3>
      {%- if summary %}
        <p>{{ summary.summary }}</p>
      {%- endif %}
      <div class="summary-meta">
        {%- if summary %}
          {%- for tag in summary.tags %}
            <span class="tag-pill">{{ tag }}</span>
          {%- endfor %}
          {%- for topic in summary.topics %}
            <span class="tag-pill">{{ topic }}</span>
          {%- endfor %}
          {%- for category in summary.categories %}
            <span class="tag-pill">{{ category }}</span>
          {%- endfor %}
        {%- endif %}
      </div>
      <div class="summary-links">
        {%- if summary %}
          <a href="{{ ('/summaries/' ~ source.id ~ '/') | url }}">Summary</a>
        {%- endif %}
        {%- if source.url %}
          <a href="{{ source.url }}">Original source</a>
        {%- endif %}
      </div>
    </article>
  {%- endfor %}
</div>

<p class="search-empty" data-bibliography-empty hidden>No sources match this search.</p>

<script>
  (function () {
    const input = document.querySelector('[data-bibliography-search]');
    const cards = Array.from(document.querySelectorAll('[data-bibliography-card]'));
    const emptyState = document.querySelector('[data-bibliography-empty]');

    if (!input) return;

    const update = () => {
      const term = input.value.trim().toLowerCase();
      let visible = 0;
      cards.forEach((card) => {
        const haystack = card.dataset.search || '';
        const match = !term || haystack.includes(term);
        card.hidden = !match;
        if (match) visible += 1;
      });
      if (emptyState) emptyState.hidden = visible !== 0;
    };

    input.addEventListener('input', update);
  })();
</script>
